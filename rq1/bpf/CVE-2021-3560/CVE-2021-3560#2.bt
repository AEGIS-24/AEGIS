tracepoint:syscalls:sys_enter_sendmsg
/strcontains(str(((struct user_msghdr *)args->msg)->msg_iov->iov_base), "org.freedesktop.Accounts.CreateUser")/
{
    @createuser[pid] = nsecs;
}

tracepoint:syscalls:sys_enter_sendmsg
/strcontains(str(((struct user_msghdr *)args->msg)->msg_iov->iov_base), "org.freedesktop.Accounts.User.SetPassword")/
{
    if (@createuser[pid] && (nsecs - @createuser[pid] < 1000000000)) {
        printf("CVE-2021-3560 maybe triggered by pid[%d] comm[%s]\n", pid, comm);
    }
    delete(@createuser[pid]);
}