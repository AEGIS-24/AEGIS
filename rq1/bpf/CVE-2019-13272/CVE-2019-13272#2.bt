#include <linux/ptrace.h>

tracepoint:syscalls:sys_enter_ptrace
/ args.request == PTRACE_TRACEME /
{
    @traced_pids[pid] = elapsed;
}

tracepoint:syscalls:sys_enter_execve
/ @traced_pids[pid] && str(args->argv[0]) == "/usr/bin/pkexec" /
{
    if (@traced_pids[pid] < elapsed) {
        printf("CVE-2019-13272 detected by pid[%d] comm[%s]\n", pid, comm);
        delete(@traced_pids[pid]);
    }
}