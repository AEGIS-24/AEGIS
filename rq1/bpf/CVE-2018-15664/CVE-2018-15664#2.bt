#define threshold 64
#define RENAME_EXCHANGE (uint64)(1 << 1)  // Exchange source and dest during rename

tracepoint:syscalls:sys_enter_renameat2
/ args->flags == RENAME_EXCHANGE /
{
    @count[pid]++;  // Increment for each process making the renameat2 call
    if (@count[pid] > threshold)  // If count exceeds the threshold within 1 ms
    {
        printf("CVE-2018-15664 maybe triggered by pid[%d] comm[%s]\n", pid, comm);
    }
}

interval:ms:1
{
    clear(@count);  // Reset the count every 1 ms to prevent false positives
}